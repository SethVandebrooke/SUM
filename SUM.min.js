function $SUM(e,t){function r(e){return(new(function(){function e(){}return e.hash=function(t,r){var o=Object.assign({msgFormat:"string",outFormat:"hex"},r);switch(o.msgFormat){default:case"string":t=function(e){try{return(new TextEncoder).encode(e,"utf-8").reduce(function(e,t){return e+String.fromCharCode(t)},"")}catch(t){return unescape(encodeURIComponent(e))}}(t);break;case"hex-bytes":t=function(e){var t=e.replace(" ","");return""==t?"":t.match(/.{2}/g).map(function(e){return String.fromCharCode(parseInt(e,16))}).join("")}(t)}for(var n=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],i=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],s=(t+=String.fromCharCode(128)).length/4+2,a=Math.ceil(s/16),u=new Array(a),l=0;a>l;l++){u[l]=new Array(16);for(var c=0;16>c;c++)u[l][c]=t.charCodeAt(64*l+4*c+0)<<24|t.charCodeAt(64*l+4*c+1)<<16|t.charCodeAt(64*l+4*c+2)<<8|t.charCodeAt(64*l+4*c+3)<<0}var d=8*(t.length-1)/Math.pow(2,32),g=8*(t.length-1)>>>0;u[a-1][14]=Math.floor(d),u[a-1][15]=g;for(l=0;a>l;l++){for(var h=new Array(64),f=0;16>f;f++)h[f]=u[l][f];for(f=16;64>f;f++)h[f]=e.a1(h[f-2])+h[f-7]+e.a0(h[f-15])+h[f-16]>>>0;for(var m=i[0],p=i[1],b=i[2],v=i[3],S=i[4],w=i[5],A=i[6],y=i[7],f=0;64>f;f++){var O=y+e.a1(S)+e.Ch(S,w,A)+n[f]+h[f],I=e.a0(m)+e.Maj(m,p,b);y=A,A=w,w=S,S=v+O>>>0,v=b,b=p,p=m,m=O+I>>>0}i[0]=i[0]+m>>>0,i[1]=i[1]+p>>>0,i[2]=i[2]+b>>>0,i[3]=i[3]+v>>>0,i[4]=i[4]+S>>>0,i[5]=i[5]+w>>>0,i[6]=i[6]+A>>>0,i[7]=i[7]+y>>>0}for(y=0;y<i.length;y++)i[y]=("00000000"+i[y].toString(16)).slice(-8);var R="hex-w"==o.outFormat?" ":"";return i.join(R)},e.ROTR=function(e,t){return t>>>e|t<<32-e},e.a0=function(t){return e.ROTR(2,t)^e.ROTR(13,t)^e.ROTR(22,t)},e.a1=function(t){return e.ROTR(6,t)^e.ROTR(11,t)^e.ROTR(25,t)},e.a0=function(t){return e.ROTR(7,t)^e.ROTR(18,t)^t>>>3},e.a1=function(t){return e.ROTR(17,t)^e.ROTR(19,t)^t>>>10},e.Ch=function(e,t,r){return e&t^~e&r},e.Maj=function(e,t,r){return e&t^e&r^t&r},e}())).__proto__.constructor.hash(e)}function o(e,t,r){e&&("string"==typeof e?window.location.href=e:"function"==typeof e&&e(t,r))}var n=this;n.name=e,n.uid=t||"username",null!=localStorage.getItem("uid")&&(n.uid=localStorage.getItem("uid")),n.users=function(){return new function(e,t){if(this.dataSystem=t,this.name=e,null==this.dataSystem.get(e)){var r=new Array;this.dataSystem.set(e,JSON.stringify(r))}this.debug=!1,this.add=function(e){var t=JSON.parse(this.dataSystem.get(this.name));t.push(e),this.dataSystem.set(this.name,JSON.stringify(t)),!0===this.debug&&console.log(this.name+" -> add: Object successfully added!")},this.exists=function(e,t){var r=JSON.parse(this.dataSystem.get(this.name));if(r.length>0){for(var o=0;o<r.length;o++)if(r[o][e]==t)return!0===this.debug&&console.log(this.name+" -> exists: returned true"),!0;this.dataSystem.set(this.name,JSON.stringify(r))}else!0===this.debug&&console.log(this.name+" -> exists: No objects are stored!")},this.edit=function(e,t,r,o){var n=JSON.parse(this.dataSystem.get(this.name));if(n.length>0){for(var i=0;i<n.length;i++){var s=n[i];s[e]==t&&(!0===this.debug&&(console.log(this.name+" -> edit: Object before - "),console.log(s)),s[r]=o,!0===this.debug&&(console.log(this.name+" -> edit: Object after - "),console.log(s)),n[i]=s,!0===this.debug&&console.log(this.name+" -> edit: Object saved!"))}this.dataSystem.set(this.name,JSON.stringify(n))}else!0===this.debug&&console.log(this.name+" -> edit: No objects are stored!")},this.remove=function(e,t){var r=JSON.parse(this.dataSystem.get(this.name));if(r.length>0){for(var o=0;o<r.length;o++){var n=r[o];n[e]==t&&(!0===this.debug&&(console.log(this.name+" -> remove: Object matched for removal -"),console.log(n)),r.splice(o,1),!0===this.debug&&console.log(this.name+" -> remove: Object deleted!"))}this.dataSystem.set(this.name,JSON.stringify(r))}else!0===this.debug&&console.log(this.name+" -> remove: No objects are stored!")},this.get=function(e,t){for(var r=JSON.parse(this.dataSystem.get(this.name)),o=0;o<r.length;o++){var n=r[o];if(n[e]==t)return!0===this.debug&&(console.log(this.name+" -> get: Object found! "),console.log(n)),n}return!0===this.debug&&console.log(this.name+" -> get: Object not found!"),r.length<1&&!0===this.debug&&console.log(this.name+" -> get: No objects, with the property of "+e+", matched "+t),null},this.listAll=function(){var e=JSON.parse(this.dataSystem.get(this.name));return e.length<1&&!0===this.debug&&console.log(this.name+" -> listAll: There are no stored objects to return!"),!0===this.debug&&(console.log(this.name+" -> listAll: Objects were found!"),console.log(e)),e},this.clear=function(){this.dataSystem.clear()},this.where=function(e,t){for(var r=new Array,o=JSON.parse(this.dataSystem.get(this.name)),n=0;n<o.length;n++){var i=o[n];i[e]==t&&(!0===this.debug&&(console.log(this.name+" -> search: Object matched - "),console.log(i)),r.push(i))}return r.length<1&&!0===this.debug&&console.log(this.name+" -> search: No objects, with the property of "+e+", matched "+t),!0===this.debug&&(console.log(this.name+" -> search: Final result - "),console.log(r)),r}}(e+"-app-data",{set:function(e,t){return localStorage.setItem(e,t)},get:function(e){return localStorage.getItem(e)}})}(),n.register=function(t,i,s){if(!t[n.uid])throw o(s,t,"Invalid submission. "+n.uid+" required."),new Error(e+" -> Register: "+n.uid+" must be defined.");if(!t.password)throw o(s,t,"Invalid submission. Password required."),new Error(e+" -> Register: 'password' is a required property");n.users.exists(n.uid,t[n.uid])?o(s,t,"That "+n.uid+" is already in use!"):(t.password=r(t.password),n.users.add(t),sessionStorage.setItem(e+"-current-user",t[n.uid]),o(i,t))},n.update=function(e,t,i){for(var s in e)"password"==s?n.users.edit(n.uid,t,s,r(e[s])):n.users.edit(n.uid,t,s,e[s]);o(i,e,"Successfully updated user!")},n.auth=function(t,i,s){if(!t[n.uid])throw o(s,t,"Invalid authentication attempt. "+n.uid+" required."),new Error(e+" -> Auth: "+n.uid+" must be defined.");if(!t.password)throw o(s,t,"Invalid authentication attempt. Password required."),new Error(e+" -> Auth: 'password' is a required property");n.users.exists(n.uid,t[n.uid])?n.users.get(n.uid,t[n.uid]).password==r(t.password)?o(i,t):o(s,t,"Incorrect password!"):o(s,t,"User does not exist!")},n.login=function(t,r,i){n.auth(t,function(t){sessionStorage.setItem(e+"-current-user",t[n.uid]),o(r,t,"Login successfull!")},function(e){o(i,e,"Login failed!")})},n.logout=function(t){sessionStorage.removeItem(e+"-current-user"),window.location.href=t},n.loggedInAs=function(){return sessionStorage.getItem(e+"-current-user")||"User"},n.loggedIn=function(){return null!=sessionStorage.getItem(e+"-current-user")},n.currentUser=function(){return n.users.get(n.uid,n.loggedInAs())},n.getProfilePictureData=function(t){return localStorage.getItem(e+"-profilepic-"+t)},n.getForm=function(e){for(var t={},r=e.elements,o=0;o<r.length;o++)if("INPUT"==r[o].tagName||"SELECT"==r[o].tagName||"TEXTAREA"==r[o].tagName){var n=r[o].tagName+Math.floor(500*Math.random()),i=""!=r[o].name?r[o].name:""!=r[o].id?r[o].id:n,s=r[o].value;"INPUT"==!r[o].tagName&&"submit"==!r[o].type&&(r[o].value=""),t[i]=s}return t}}!function(e){var t=new $SUM("defaultApp");document.querySelectorAll("html")[0].getAttribute("require-login")&&(t.loggedIn()||(window.location.href=document.querySelectorAll("html")[0].getAttribute("require-login")));document.querySelectorAll("form").forEach(function(e){if(e.addEventListener("submit",function(r){if("login"===e.getAttribute("type")){r.preventDefault();null!=(o=e.getAttribute("uid"))&&(t.uid=o,localStorage.setItem("uid",o));n=t.getForm(e);t.login(n,e.getAttribute("on-success")||window.location.href,e.getAttribute("on-fail")||window.location.href)}if("signup"===e.getAttribute("type")){r.preventDefault();var o=e.getAttribute("uid");null!=o&&(t.uid=o,localStorage.setItem("uid",o));n=t.getForm(e);t.register(n,e.getAttribute("on-success")||window.location.href,e.getAttribute("on-fail")||window.location.href)}if("update"===e.getAttribute("type")){r.preventDefault();var n=t.getForm(e);t.update(n,t.loggedInAs(),e.getAttribute("on-success")||window.location.href)}}),"update"===e.getAttribute("type")){var r=t.currentUser();for(var o in r)e.querySelectorAll("#"+o+", [name='"+o+"']").forEach(function(e){"password"!=o&&e.setAttribute("value",r[o])})}});document.querySelectorAll("[logout]").forEach(function(e){e.addEventListener("click",function(r){t.logout(e.getAttribute("logout")||"index.html")})});var r=t.currentUser();for(var o in r){var n=document.querySelectorAll(o);console.log("element: ",n),n.forEach(function(e){e.innerHTML=r[o]})}document.querySelectorAll("[upload='profile-pic']").forEach(function(e){e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.addEventListener("change",function(e){!function(e){var r=e.target,o=new FileReader;o.onload=function(){var e=o.result;localStorage.setItem(t.name+"-profilepic-"+t.loggedInAs(),e),document.querySelectorAll("[profile-pic]").forEach(function(t){t.setAttribute("src",e)})},o.readAsDataURL(r.files[0])}(e)})});document.querySelectorAll("[profile-pic]").forEach(function(e){e.setAttribute("src",t.getProfilePictureData(e.getAttribute("profile-pic")?e.getAttribute("profile-pic"):t.loggedInAs()))}),e.app=t}(window);
