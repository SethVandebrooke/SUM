function SUM(e,t,n,o){function r(e){return(new(function(){function e(){}return e.hash=function(t,n){var o=Object.assign({msgFormat:"string",outFormat:"hex"},n);switch(o.msgFormat){default:case"string":t=function(e){try{return(new TextEncoder).encode(e,"utf-8").reduce(function(e,t){return e+String.fromCharCode(t)},"")}catch(t){return unescape(encodeURIComponent(e))}}(t);break;case"hex-bytes":t=function(e){var t=e.replace(" ","");return""==t?"":t.match(/.{2}/g).map(function(e){return String.fromCharCode(parseInt(e,16))}).join("")}(t)}for(var r=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],i=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],s=(t+=String.fromCharCode(128)).length/4+2,a=Math.ceil(s/16),u=new Array(a),l=0;a>l;l++){u[l]=new Array(16);for(var c=0;16>c;c++)u[l][c]=t.charCodeAt(64*l+4*c+0)<<24|t.charCodeAt(64*l+4*c+1)<<16|t.charCodeAt(64*l+4*c+2)<<8|t.charCodeAt(64*l+4*c+3)<<0}var d=8*(t.length-1)/Math.pow(2,32),g=8*(t.length-1)>>>0;u[a-1][14]=Math.floor(d),u[a-1][15]=g;for(l=0;a>l;l++){for(var f=new Array(64),h=0;16>h;h++)f[h]=u[l][h];for(h=16;64>h;h++)f[h]=e.a1(f[h-2])+f[h-7]+e.a0(f[h-15])+f[h-16]>>>0;for(var m=i[0],p=i[1],w=i[2],b=i[3],v=i[4],A=i[5],S=i[6],y=i[7],h=0;64>h;h++){var O=y+e.a1(v)+e.Ch(v,A,S)+r[h]+f[h],I=e.a0(m)+e.Maj(m,p,w);y=S,S=A,A=v,v=b+O>>>0,b=w,w=p,p=m,m=O+I>>>0}i[0]=i[0]+m>>>0,i[1]=i[1]+p>>>0,i[2]=i[2]+w>>>0,i[3]=i[3]+b>>>0,i[4]=i[4]+v>>>0,i[5]=i[5]+A>>>0,i[6]=i[6]+S>>>0,i[7]=i[7]+y>>>0}for(y=0;y<i.length;y++)i[y]=("00000000"+i[y].toString(16)).slice(-8);var R="hex-w"==o.outFormat?" ":"";return i.join(R)},e.ROTR=function(e,t){return t>>>e|t<<32-e},e.a0=function(t){return e.ROTR(2,t)^e.ROTR(13,t)^e.ROTR(22,t)},e.a1=function(t){return e.ROTR(6,t)^e.ROTR(11,t)^e.ROTR(25,t)},e.a0=function(t){return e.ROTR(7,t)^e.ROTR(18,t)^t>>>3},e.a1=function(t){return e.ROTR(17,t)^e.ROTR(19,t)^t>>>10},e.Ch=function(e,t,n){return e&t^~e&n},e.Maj=function(e,t,n){return e&t^e&n^t&n},e}())).__proto__.constructor.hash(e)}function i(e,t,n){if(e)if("string"==typeof e)window.location.href=e;else if("function"==typeof e){e({data:t,message:n})}}var s=this;s.name=e,s.uid=t||"username",null!=localStorage.getItem("uid")&&(s.uid=localStorage.getItem("uid")),s.extentions=null,s.users=function(){function t(e){if(this.name=e,this.dataSystem={set:function(e,t){return localStorage.setItem(e,t)},get:function(e){return localStorage.getItem(e)}},this.name=e,null==this.dataSystem.get(e)){var t=new Array;this.dataSystem.set(e,JSON.stringify(t))}this.debug=!1,this.add=function(e){var t=JSON.parse(this.dataSystem.get(this.name));t.push(e),this.dataSystem.set(this.name,JSON.stringify(t)),!0===this.debug&&console.log(this.name+" -> add: Object successfully added!")},this.exists=function(e,t){var n=JSON.parse(this.dataSystem.get(this.name));if(n.length>0){for(var o=0;o<n.length;o++){if(n[o][e]==t)return!0===this.debug&&console.log(this.name+" -> exists: returned true"),!0}this.dataSystem.set(this.name,JSON.stringify(n))}else!0===this.debug&&console.log(this.name+" -> exists: No objects are stored!")},this.edit=function(e,t,n,o){var r=JSON.parse(this.dataSystem.get(this.name));if(r.length>0){for(var i=0;i<r.length;i++){var s=r[i];s[e]==t&&(!0===this.debug&&(console.log(this.name+" -> edit: Object before - "),console.log(s)),s[n]=o,!0===this.debug&&(console.log(this.name+" -> edit: Object after - "),console.log(s)),r[i]=s,!0===this.debug&&console.log(this.name+" -> edit: Object saved!"))}this.dataSystem.set(this.name,JSON.stringify(r))}else!0===this.debug&&console.log(this.name+" -> edit: No objects are stored!")},this.remove=function(e,t){var n=JSON.parse(this.dataSystem.get(this.name));if(n.length>0){for(var o=0;o<n.length;o++){var r=n[o];r[e]==t&&(!0===this.debug&&(console.log(this.name+" -> remove: Object matched for removal -"),console.log(r)),n.splice(o,1),!0===this.debug&&console.log(this.name+" -> remove: Object deleted!"))}this.dataSystem.set(this.name,JSON.stringify(n))}else!0===this.debug&&console.log(this.name+" -> remove: No objects are stored!")},this.get=function(e,t){for(var n=JSON.parse(this.dataSystem.get(this.name)),o=0;o<n.length;o++){var r=n[o];if(r[e]==t)return!0===this.debug&&(console.log(this.name+" -> get: Object found! "),console.log(r)),r}return!0===this.debug&&console.log(this.name+" -> get: Object not found!"),n.length<1&&!0===this.debug&&console.log(this.name+" -> get: No objects, with the property of "+e+", matched "+t),null},this.listAll=function(){var e=JSON.parse(this.dataSystem.get(this.name));return e.length<1&&!0===this.debug&&console.log(this.name+" -> listAll: There are no stored objects to return!"),!0===this.debug&&(console.log(this.name+" -> listAll: Objects were found!"),console.log(e)),e},this.clear=function(){this.dataSystem.clear()},this.where=function(e,t){for(var n=new Array,o=JSON.parse(this.dataSystem.get(this.name)),r=0;r<o.length;r++){var i=o[r];i[e]==t&&(!0===this.debug&&(console.log(this.name+" -> search: Object matched - "),console.log(i)),n.push(i))}return n.length<1&&!0===this.debug&&console.log(this.name+" -> search: No objects, with the property of "+e+", matched "+t),!0===this.debug&&(console.log(this.name+" -> search: Final result - "),console.log(n)),n}}return s.extentions=new t(e+"-extensions"),new t(e+"-app-data")}(),s.extentions.update=function(e){for(var t in e)s.extentions.edit("name",e.name,t,e[t])},s.signup=function(t,n,o){if(!t[s.uid])throw i(o,t,"Invalid submission. "+s.uid+" required."),new Error(e+" -> Register: "+s.uid+" must be defined.");if(!t.password)throw i(o,t,"Invalid submission. Password required."),new Error(e+" -> Register: 'password' is a required property");s.users.exists(s.uid,t[s.uid])?i(o,t,"That "+s.uid+" is already in use!"):(t.password=r(t.password),t.joinedOn=new Date,t.lastUpdated=new Date,t.guid=btoa(""+1e12*Math.random()),s.users.add(t),sessionStorage.setItem(e+"-current-user",t.guid),i(n,t))},s.update=function(e,t,n){for(var o in e)"password"==o?s.users.edit("guid",t,o,r(e[o])):s.users.edit("guid",t,o,e[o]);s.users.edit(s.uid,id,"lastUpdated",new Date),i(n,e,"Successfully updated user!")},s.auth=function(t,n,o){if(!t[s.uid])throw i(o,t,"Invalid authentication attempt. "+s.uid+" required."),new Error(e+" -> Auth: "+s.uid+" must be defined.");if(!t.password)throw i(o,t,"Invalid authentication attempt. Password required."),new Error(e+" -> Auth: 'password' is a required property");s.users.exists(s.uid,t[s.uid])?s.users.get(s.uid,t[s.uid]).password==r(t.password)?i(n,t):i(o,t,"Incorrect password!"):i(o,t,"User does not exist!")},s.login=function(t,n,o){s.auth(t,function(t){var o=s.users.get(s.uid,t.data[s.uid]);sessionStorage.setItem(e+"-current-user",o.guid),i(n,t.data,"Login successfull!")},function(e){i(o,e.data,"Login failed!")})},s.logout=function(t){sessionStorage.removeItem(e+"-current-user"),window.location.href=t},s.loggedInAs=function(){return sessionStorage.getItem(e+"-current-user")||"User"},s.loggedIn=function(){return null!=sessionStorage.getItem(e+"-current-user")},s.currentUser=function(){return s.users.get("guid",s.loggedInAs())},s.deleteUserAccount=function(t,n,o){s.auth(t,function(t){sessionStorage.setItem(e+"-current-user",t.data[s.uid]),s.users.remove(s.uid,t[s.uid]),i(n,t.data,"User deleted!")},function(e){i(o,e.data,"User does not exist!")})},s.getProfilePictureData=function(t){return localStorage.getItem(e+"-profilepic-"+(t||s.loggedInAs()))||!1},s.reset=function(){localStorage.clear(),sessionStorage.clear(),window.location.href=window.location.href},s.setSecurityQuestion=function(e,t,n){e.SQ=t,e.SQA=r(n)},s.forgotPassword=function(e,t,n,o,a){if(s.users.exists(s.uid,e)){var u=s.users.get(s.uid,e);u.SQA===r(t)?(s.users.update(s.uid,e,"password",n),i(o,u=s.users.get(s.uid,e),"Successfully changed password!")):i(a,{},"Wrong answer.")}else i(a,{},"That "+s.uid+" isn't used in this application.")},s.getForm=function(e){for(var t={},n=e.elements,o=0;o<n.length;o++)if("INPUT"==n[o].tagName||"SELECT"==n[o].tagName||"TEXTAREA"==n[o].tagName){var r=n[o].tagName+Math.floor(500*Math.random()),i=""!=n[o].name?n[o].name:""!=n[o].id?n[o].id:r,s=n[o].value;"INPUT"==!n[o].tagName&&"submit"==!n[o].type&&(n[o].value=""),i.toLowerCase().replace("submit","")===i.toLowerCase()&&i.toLowerCase().replace("confirm","")===i.toLowerCase()&&(t[i]=s)}return t},s.newComponent=function(e,t,n,o){document.querySelectorAll(t).forEach(function(e){n(e)});var r={name:e,id:btoa(e+t+Math.floor(1e3*Math.random())),selector:t,operation:n.toString(),description:o||""};s.extentions.exists("name",e)?s.extentions.exists("name",e)&&s.extentions.update(r):s.extentions.add(r)},s.generateView=function(e,t,n){n=n||(e.innerHTML||"");e.innerHTML="",(t=t||[]).forEach(function(t){var o=n;for(var r in t)o=o.split("$"+r).join(t[r]);e.innerHTML+=o})},s.parseURL=function(e){var t=window.location.href,n={};if("check"===(e=e&&("?"===e||"#"===e)?e:"check")&&!1===(e=t.includes("?")?"?":!!t.includes("#")&&"#"))return!1;if((t=t.substring(t.indexOf(e)+1,t.length)).includes("=")){var o=t.split("&");return o.forEach(function(e){n[e.split("=")[0]]=e.split("=")[1]}),o[0].split("=").length>1?n:t}return t},s.run=function(){s.newComponent("from-url","[from-url]",function(e){var t=e.getAttribute("from-url").split(" ").join("").split(","),n=s.parseURL();t.forEach(function(t){var o=t.split(":");"text"==o[0]?e.innerHTML=n[o[1]]:e.setAttribute(o[0],n[o[1]])})}),document.querySelectorAll("form").forEach(function(t){var n=t.getAttribute("type");if("signup"===n&&localStorage.setItem(e+"-blueprint",JSON.stringify(s.getForm(t))),t.addEventListener("submit",function(e){var o=s.getForm(t),r=t.getAttribute("uid");null!=r&&(s.uid=r,localStorage.setItem("uid",r)),"login"===n||"signup"===n?(e.preventDefault(),s[n](o,t.getAttribute("on-success")||window.location.href,t.getAttribute("on-fail")||window.location.href)):"update"===n&&(e.preventDefault(),s.update(o,s.loggedInAs(),t.getAttribute("on-success")||window.location.href))}),"update"===n){var o=s.currentUser();for(var r in o)t.querySelectorAll("#"+r+", [name='"+r+"']").forEach(function(e){"password"!=r&&e.setAttribute("value",o[r])})}}),s.newComponent("Logout","[logout]",function(e){e.addEventListener("click",function(t){s.logout(e.getAttribute("logout")||window.location.href)})},"Logout the user when clicked."),s.newComponent("Delete User","[delete-user-account]",function(e){s.deleteUserAccount(e.getAttribute("delete-user-account")?e.getAttribute("delete-user-account"):s.loggedInAs(),e.getAttribute("on-success")||window.location.href,e.getAttribute("on-fail")||window.location.href)},"Delete user account when clicked.");var t=s.currentUser();for(var n in t)s.newComponent(n,n,function(e){e.innerHTML=t[n]},"Display "+n+" value of the user that is logged in.");s.newComponent("Display Users","users",function(e){s.generateView(e,s.users.listAll())},"For each user, display the innerHTML of the given element after replacing each $propertyName with its value."),s.newComponent("App name","app-name",function(e){e.innerHTML=s.name},"Display app name.");s.newComponent("Upload Profile Picture","[upload='profile-pic']",function(e){e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.addEventListener("change",function(e){!function(e){var t=e.target,n=new FileReader;n.onload=function(){var e=n.result;localStorage.setItem(s.name+"-profilepic-"+s.loggedInAs(),e),document.querySelectorAll("[profile-pic=''], [profile-pic='"+s.loggedInAs()+"']").forEach(function(t){t.setAttribute("src",e)})},n.readAsDataURL(t.files[0])}(e)})},"Set up the given input element to upload the profile picture for the user that is logged in."),s.newComponent("Display Profile Picture","[profile-pic]",function(e){e.getAttribute("profile-pic");s.getProfilePictureData(e.getAttribute("profile-pic")?e.getAttribute("profile-pic"):s.loggedInAs())&&e.setAttribute("src",s.getProfilePictureData(e.getAttribute("profile-pic")?e.getAttribute("profile-pic"):s.loggedInAs()))},"Display profile picture for the user that is specified, or if set to nothing the user that is logged in.")},document.querySelectorAll("html")[0].getAttribute("require-login")&&(s.loggedIn()||(window.location.href=o||document.querySelectorAll("html")[0].getAttribute("require-login"))),document.querySelectorAll("html")[0].getAttribute("logged-in")&&s.loggedIn()&&(window.location.href=n||document.querySelectorAll("html")[0].getAttribute("logged-in"))}var auto=!0;!function(e){if(auto){var t=new SUM("defaultApp");t.run(),e.app=t}}(window);
